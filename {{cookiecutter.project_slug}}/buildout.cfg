[buildout]
index = https://pypi.org/simple
extends = http://dist.plone.org/release/5.1.4/versions.cfg
show-picked-versions = true
extensions = mr.developer
auto-checkout = *
parts =
    instance
    plonesite
    code-analysis
    test
    test-acceptance
    releaser
    i18ndude
    omelette
    robot


[sources]
{{cookiecutter.project_slug}}.core = fs {{cookiecutter.project_slug}}.core
# {{cookiecutter.project_slug}}.theme = fs {{cookiecutter.project_slug}}.theme


[instance]
recipe = plone.recipe.zope2instance
user = admin:admin
http-address = 8080
eggs =
    Plone
    Pillow
    plone.reload
    {{cookiecutter.project_slug}}.core [test]
#    {{cookiecutter.project_slug}}.theme [test]
zcml = {{cookiecutter.project_slug}}.core

zcml-additional =
  <configure xmlns="http://namespaces.zope.org/zope"
             xmlns:plone="http://namespaces.plone.org/plone"
             xmlns:zcml="http://namespaces.zope.org/zcml"
             zcml:condition="installed plone.restapi">
    <plone:CORSPolicy
        allow_origin="http://localhost:3000,http://127.0.0.1:3000"
        allow_methods="DELETE,GET,OPTIONS,PATCH,POST,PUT"
        allow_credentials="true"
        expose_headers="Content-Length,X-My-Header"
        allow_headers="Accept,Authorization,Content-Type,X-Custom-Header"
        max_age="3600"
        />
  </configure>

environment-vars = zope_i18n_compile_mo_files true

[plonesite]
recipe = collective.recipe.plonesite
site-id = Plone
instance = instance
profiles-initial = Products.CMFPlone:dependencies
profiles =
    plonetheme.barceloneta:default
    plone.app.contenttypes:plone-content
#    plone.restapi:default
    {{cookiecutter.project_slug}}.core:content
upgrade-portal = False
upgrade-all-profiles = False
site-replace = True


[code-analysis]
recipe = plone.recipe.codeanalysis
directory = ${buildout:directory}/src
flake8-exclude = bootstrap.py,bootstrap-buildout.py,docs,*.egg.,omelette
flake8-max-complexity = 30
return-status-codes = False
pre-commit-hook = True


[omelette]
recipe = collective.recipe.omelette
eggs = ${instance:eggs}


[test]
recipe = collective.xmltestreport
eggs = ${instance:eggs}
defaults = ['-s', '{{cookiecutter.project_slug}}.core', '--auto-color', '--auto-progress']
environment = environment


[test-acceptance]
recipe = collective.recipe.template
input = inline:
    #!/bin/bash
    export ROBOTSUITE_PREFIX=ONLYROBOT && bin/test -t ONLYROBOT --all
output = ${buildout:directory}/bin/test-acceptance
mode = 755


[supervisor]
recipe = collective.recipe.supervisor
programs =
    10 instance ${buildout:directory}/bin/instance [console] true kitconcept

supervisord-user = kitconcept
http-socket = unix
file = ${buildout:directory}/var/supervisord.sock
serverurl = unix://${buildout:directory}/var/supervisord.sock


[robot]
recipe = zc.recipe.egg
eggs =
    ${test:eggs}
    plone.app.robotframework[debug,ride,reload]


[releaser]
recipe = zc.recipe.egg
eggs = zest.releaser


[i18ndude]
recipe = zc.recipe.egg
eggs = i18ndude


[environment]
ROBOT_SELENIUM2LIBRARY_RUN_ON_FAILURE = Capture page screenshot and log source


[versions]
# Don't use a released version of {{cookiecutter.project_slug}}.core
{{cookiecutter.project_slug}}.core =

# setuptools / buildout
setuptools =
zc.buildout =
zc.recipe.egg = 2.0.3

# plone.restapi
plone.schema = 1.2.0
PyJWT = 1.6.4
jsonschema = 2.6.0

plone.recipe.zope2instance = 4.4.0

# code analysis
plone.recipe.codeanalysis = 2.3
pep8 = 1.7.1
flake8 = 3.5.0
flake8-blind-except = 0.1.0
flake8-coding = 1.3.0
flake8-debugger = 1.4.0
flake8-deprecated = 1.0
flake8-isort = 0.2
flake8-pep3101 = 0.3
flake8-plone-api = 1.0
flake8-plone-hasattr = 0.1
flake8-print = 2.0.2
flake8-quotes = 0.1.1
flake8-string-format = 0.2.1
flake8-todo = 0.7
check-manifest = 0.36
configparser = 3.5.0
mccabe = 0.6.1
pyflakes = 1.6.0
pycodestyle = 2.3.1

# misc
i18ndude = 4.0.1

# robot framework
plone.app.robotframework = 1.2.1
robotframework = 3.0.4
robotframework-selenium2library = 3.0.0
robotframework-seleniumlibrary = 3.1.1
robotsuite = 2.0.0
selenium = 2.53.6
plone.testing = 5.0.0

# varnish
plone.recipe.varnish = 1.3
jinja2 = 2.5.5
